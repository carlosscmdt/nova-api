// ================================
// Nova - Shopify Theme Generator
// Creates real Shopify Liquid templates like gelexobel.de
// ================================

export class ThemeGenerator {
  constructor(content, productData) {
    this.content = content;
    this.product = productData;
    this.brandName = content.brandName || "Nova Store";
  }

  // ================================
  // Generate Complete Theme Package
  // ================================
  generateTheme() {
    return {
      sections: {
        "header.liquid": this.generateHeaderSection(),
        "announcement-bar.liquid": this.generateAnnouncementBar(),
        "main-product.liquid": this.generateMainProduct(),
        "product-hero.liquid": this.generateProductHero(),
        "featured-product.liquid": this.generateFeaturedProduct(),
        "testimonials.liquid": this.generateTestimonials(),
        "features-grid.liquid": this.generateFeaturesGrid(),
        "image-with-text.liquid": this.generateImageWithText(),
        "faq.liquid": this.generateFAQ(),
        "trust-badges.liquid": this.generateTrustBadges(),
        "footer.liquid": this.generateFooter(),
      },
      snippets: {
        "price.liquid": this.generatePriceSnippet(),
        "product-media.liquid": this.generateProductMedia(),
        "quantity-input.liquid": this.generateQuantityInput(),
        "buy-buttons.liquid": this.generateBuyButtons(),
        "icon-star.liquid": this.generateIconStar(),
      },
      templates: {
        "index.json": this.generateIndexTemplate(),
        "product.json": this.generateProductTemplate(),
      },
      config: {
        "settings_schema.json": this.generateSettingsSchema(),
        "settings_data.json": this.generateSettingsData(),
      },
    };
  }

  // ================================
  // Header Section (like gelexobel.de)
  // ================================
  generateHeaderSection() {
    return `{% comment %}
  Nova Theme - Premium Header Section
  Generated by Nova AI Store Builder
{% endcomment %}

{%- style -%}
  .header {
    background: {{ section.settings.background_color }};
    padding: 0 3rem;
  }

  .header__wrapper {
    display: flex;
    align-items: center;
    justify-content: space-between;
    max-width: 1400px;
    margin: 0 auto;
    height: {{ section.settings.header_height }}px;
  }

  .header__logo {
    font-size: 1.8rem;
    font-weight: 700;
    color: {{ section.settings.text_color }};
    text-decoration: none;
    letter-spacing: -0.02em;
  }

  .header__nav {
    display: flex;
    gap: 2.5rem;
    align-items: center;
  }

  .header__nav-link {
    color: {{ section.settings.text_color }};
    text-decoration: none;
    font-size: 0.95rem;
    font-weight: 500;
    transition: opacity 0.2s;
  }

  .header__nav-link:hover {
    opacity: 0.7;
  }

  .header__actions {
    display: flex;
    align-items: center;
    gap: 1.5rem;
  }

  .header__cart {
    position: relative;
    color: {{ section.settings.text_color }};
  }

  .header__cart-count {
    position: absolute;
    top: -8px;
    right: -8px;
    background: {{ section.settings.accent_color }};
    color: white;
    font-size: 0.7rem;
    font-weight: 600;
    width: 18px;
    height: 18px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .header--sticky {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    z-index: 1000;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
  }

  @media (max-width: 768px) {
    .header {
      padding: 0 1rem;
    }
    .header__nav {
      display: none;
    }
    .header__mobile-toggle {
      display: block;
    }
  }
{%- endstyle -%}

<header class="header{% if section.settings.sticky_header %} header--sticky{% endif %}" data-header>
  <div class="header__wrapper">
    <a href="{{ routes.root_url }}" class="header__logo">
      {%- if section.settings.logo != blank -%}
        <img src="{{ section.settings.logo | image_url: width: 200 }}" alt="{{ shop.name }}" height="40">
      {%- else -%}
        {{ shop.name }}
      {%- endif -%}
    </a>

    <nav class="header__nav">
      {%- for link in section.settings.menu.links -%}
        <a href="{{ link.url }}" class="header__nav-link">{{ link.title }}</a>
      {%- endfor -%}
    </nav>

    <div class="header__actions">
      <a href="{{ routes.cart_url }}" class="header__cart">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"></path>
          <line x1="3" y1="6" x2="21" y2="6"></line>
          <path d="M16 10a4 4 0 0 1-8 0"></path>
        </svg>
        {%- if cart.item_count > 0 -%}
          <span class="header__cart-count">{{ cart.item_count }}</span>
        {%- endif -%}
      </a>

      <button class="header__mobile-toggle" aria-label="Menu" hidden>
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="3" y1="12" x2="21" y2="12"></line>
          <line x1="3" y1="6" x2="21" y2="6"></line>
          <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </button>
    </div>
  </div>
</header>

{% schema %}
{
  "name": "Header",
  "class": "section-header",
  "settings": [
    {
      "type": "image_picker",
      "id": "logo",
      "label": "Logo"
    },
    {
      "type": "link_list",
      "id": "menu",
      "default": "main-menu",
      "label": "Menu"
    },
    {
      "type": "checkbox",
      "id": "sticky_header",
      "default": true,
      "label": "Sticky header"
    },
    {
      "type": "range",
      "id": "header_height",
      "min": 60,
      "max": 120,
      "step": 4,
      "default": 80,
      "unit": "px",
      "label": "Header height"
    },
    {
      "type": "color",
      "id": "background_color",
      "default": "#ffffff",
      "label": "Background color"
    },
    {
      "type": "color",
      "id": "text_color",
      "default": "#1a1a1a",
      "label": "Text color"
    },
    {
      "type": "color",
      "id": "accent_color",
      "default": "#000000",
      "label": "Accent color"
    }
  ]
}
{% endschema %}`;
  }

  // ================================
  // Announcement Bar
  // ================================
  generateAnnouncementBar() {
    const announcement = this.content.announcementBar || "üî• FREE SHIPPING on orders over $75";

    return `{% comment %}
  Nova Theme - Announcement Bar
{% endcomment %}

{%- style -%}
  .announcement-bar {
    background: {{ section.settings.background_color }};
    color: {{ section.settings.text_color }};
    padding: 0.75rem 1rem;
    text-align: center;
    font-size: 0.875rem;
    font-weight: 500;
  }

  .announcement-bar__message {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
  }

  .announcement-bar__link {
    color: inherit;
    text-decoration: underline;
    text-underline-offset: 2px;
  }

  .announcement-bar--scrolling .announcement-bar__content {
    animation: scroll 20s linear infinite;
  }

  @keyframes scroll {
    0% { transform: translateX(100%); }
    100% { transform: translateX(-100%); }
  }
{%- endstyle -%}

{%- if section.settings.show_announcement_bar -%}
  <div class="announcement-bar color-{{ section.settings.color_scheme }}">
    <div class="announcement-bar__message">
      {%- if section.settings.link != blank -%}
        <a href="{{ section.settings.link }}" class="announcement-bar__link">
          {{ section.settings.text | default: "${announcement}" }}
        </a>
      {%- else -%}
        {{ section.settings.text | default: "${announcement}" }}
      {%- endif -%}
    </div>
  </div>
{%- endif -%}

{% schema %}
{
  "name": "Announcement bar",
  "settings": [
    {
      "type": "checkbox",
      "id": "show_announcement_bar",
      "default": true,
      "label": "Show announcement bar"
    },
    {
      "type": "text",
      "id": "text",
      "default": "${announcement}",
      "label": "Text"
    },
    {
      "type": "url",
      "id": "link",
      "label": "Link"
    },
    {
      "type": "color",
      "id": "background_color",
      "default": "#1a1a1a",
      "label": "Background"
    },
    {
      "type": "color",
      "id": "text_color",
      "default": "#ffffff",
      "label": "Text color"
    }
  ]
}
{% endschema %}`;
  }

  // ================================
  // Main Product Section (like gelexobel.de)
  // ================================
  generateMainProduct() {
    const productContent = this.content.product || {};
    const urgencyMessage = productContent.urgencyMessage || "Only 23 left in stock!";
    const socialProof = productContent.socialProof || "47,000+ happy customers";

    return `{% comment %}
  Nova Theme - Main Product Section
  Premium product page like gelexobel.de
{% endcomment %}

{%- style -%}
  .product-section {
    padding: 2rem 1rem 4rem;
    max-width: 1400px;
    margin: 0 auto;
  }

  .product__grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 4rem;
    align-items: start;
  }

  .product__media-wrapper {
    position: sticky;
    top: 100px;
  }

  .product__media-main {
    aspect-ratio: 1;
    background: #f8f8f8;
    border-radius: 12px;
    overflow: hidden;
    margin-bottom: 1rem;
  }

  .product__media-main img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .product__media-thumbnails {
    display: flex;
    gap: 0.75rem;
    overflow-x: auto;
  }

  .product__media-thumbnail {
    width: 80px;
    height: 80px;
    border-radius: 8px;
    overflow: hidden;
    cursor: pointer;
    border: 2px solid transparent;
    transition: border-color 0.2s;
  }

  .product__media-thumbnail.active,
  .product__media-thumbnail:hover {
    border-color: #1a1a1a;
  }

  .product__info {
    padding-top: 1rem;
  }

  .product__badges {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 1rem;
  }

  .product__badge {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    padding: 0.35rem 0.75rem;
    background: #f0f0f0;
    border-radius: 100px;
    font-size: 0.75rem;
    font-weight: 600;
    text-transform: uppercase;
  }

  .product__badge--sale {
    background: #dc2626;
    color: white;
  }

  .product__badge--bestseller {
    background: #f59e0b;
    color: white;
  }

  .product__title {
    font-size: 2.25rem;
    font-weight: 700;
    line-height: 1.2;
    margin: 0 0 0.5rem;
    color: #1a1a1a;
  }

  .product__subtitle {
    font-size: 1.125rem;
    color: #666;
    margin-bottom: 1.5rem;
  }

  .product__rating {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    margin-bottom: 1.5rem;
  }

  .product__stars {
    display: flex;
    gap: 2px;
    color: #f59e0b;
  }

  .product__rating-text {
    font-size: 0.875rem;
    color: #666;
  }

  .product__price-wrapper {
    display: flex;
    align-items: baseline;
    gap: 1rem;
    margin-bottom: 0.5rem;
  }

  .product__price {
    font-size: 2rem;
    font-weight: 700;
    color: #1a1a1a;
  }

  .product__compare-price {
    font-size: 1.25rem;
    color: #999;
    text-decoration: line-through;
  }

  .product__save-badge {
    background: #dcfce7;
    color: #16a34a;
    padding: 0.25rem 0.75rem;
    border-radius: 100px;
    font-size: 0.875rem;
    font-weight: 600;
  }

  .product__urgency {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1rem;
    background: #fef2f2;
    border-radius: 8px;
    margin-bottom: 1.5rem;
    font-size: 0.875rem;
    color: #dc2626;
    font-weight: 500;
  }

  .product__urgency svg {
    flex-shrink: 0;
  }

  .product__social-proof {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 1rem;
    background: #f8f8f8;
    border-radius: 8px;
    margin-bottom: 1.5rem;
  }

  .product__social-avatars {
    display: flex;
  }

  .product__social-avatar {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    border: 2px solid white;
    margin-left: -8px;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  }

  .product__social-avatar:first-child {
    margin-left: 0;
  }

  .product__social-text {
    font-size: 0.875rem;
    color: #666;
  }

  .product__social-text strong {
    color: #1a1a1a;
  }

  .product__variants {
    margin-bottom: 1.5rem;
  }

  .product__variant-label {
    font-size: 0.875rem;
    font-weight: 600;
    margin-bottom: 0.75rem;
    color: #1a1a1a;
  }

  .product__variant-options {
    display: flex;
    flex-wrap: wrap;
    gap: 0.5rem;
  }

  .product__variant-option {
    padding: 0.75rem 1.5rem;
    border: 2px solid #e5e5e5;
    border-radius: 8px;
    background: white;
    cursor: pointer;
    font-size: 0.875rem;
    font-weight: 500;
    transition: all 0.2s;
  }

  .product__variant-option:hover {
    border-color: #1a1a1a;
  }

  .product__variant-option.selected {
    border-color: #1a1a1a;
    background: #1a1a1a;
    color: white;
  }

  .product__quantity {
    margin-bottom: 1.5rem;
  }

  .product__quantity-label {
    font-size: 0.875rem;
    font-weight: 600;
    margin-bottom: 0.75rem;
    color: #1a1a1a;
  }

  .product__quantity-selector {
    display: inline-flex;
    align-items: center;
    border: 2px solid #e5e5e5;
    border-radius: 8px;
    overflow: hidden;
  }

  .product__quantity-btn {
    width: 44px;
    height: 44px;
    border: none;
    background: white;
    cursor: pointer;
    font-size: 1.25rem;
    color: #1a1a1a;
    transition: background 0.2s;
  }

  .product__quantity-btn:hover {
    background: #f5f5f5;
  }

  .product__quantity-input {
    width: 60px;
    height: 44px;
    border: none;
    text-align: center;
    font-size: 1rem;
    font-weight: 600;
  }

  .product__add-to-cart {
    width: 100%;
    padding: 1.125rem 2rem;
    background: #1a1a1a;
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
    margin-bottom: 0.75rem;
  }

  .product__add-to-cart:hover {
    background: #333;
    transform: translateY(-1px);
  }

  .product__buy-now {
    width: 100%;
    padding: 1.125rem 2rem;
    background: #5a31f4;
    color: white;
    border: none;
    border-radius: 8px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
  }

  .product__buy-now:hover {
    background: #4a25d4;
  }

  .product__payment-icons {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    margin-top: 1rem;
    padding-top: 1rem;
    border-top: 1px solid #e5e5e5;
  }

  .product__trust-badges {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1rem;
    margin-top: 1.5rem;
    padding-top: 1.5rem;
    border-top: 1px solid #e5e5e5;
  }

  .product__trust-badge {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    font-size: 0.875rem;
    color: #666;
  }

  .product__trust-badge svg {
    color: #16a34a;
    flex-shrink: 0;
  }

  .product__description {
    margin-top: 2rem;
    padding-top: 2rem;
    border-top: 1px solid #e5e5e5;
  }

  .product__description h3 {
    font-size: 1.25rem;
    font-weight: 600;
    margin-bottom: 1rem;
  }

  .product__description-content {
    color: #666;
    line-height: 1.7;
  }

  .product__bullets {
    list-style: none;
    padding: 0;
    margin: 1.5rem 0;
  }

  .product__bullet {
    display: flex;
    align-items: flex-start;
    gap: 0.75rem;
    padding: 0.5rem 0;
    color: #1a1a1a;
  }

  .product__bullet svg {
    color: #16a34a;
    flex-shrink: 0;
    margin-top: 2px;
  }

  @media (max-width: 968px) {
    .product__grid {
      grid-template-columns: 1fr;
      gap: 2rem;
    }

    .product__media-wrapper {
      position: relative;
      top: 0;
    }

    .product__title {
      font-size: 1.75rem;
    }
  }
{%- endstyle -%}

<section class="product-section">
  <div class="product__grid">
    <!-- Product Media -->
    <div class="product__media-wrapper">
      <div class="product__media-main" data-product-media-main>
        {%- if product.featured_image -%}
          <img
            src="{{ product.featured_image | image_url: width: 1200 }}"
            alt="{{ product.featured_image.alt | escape }}"
            loading="eager"
          >
        {%- else -%}
          {{ 'product-1' | placeholder_svg_tag }}
        {%- endif -%}
      </div>

      {%- if product.images.size > 1 -%}
        <div class="product__media-thumbnails">
          {%- for image in product.images -%}
            <div class="product__media-thumbnail{% if forloop.first %} active{% endif %}" data-thumbnail="{{ forloop.index0 }}">
              <img
                src="{{ image | image_url: width: 200 }}"
                alt="{{ image.alt | escape }}"
                loading="lazy"
              >
            </div>
          {%- endfor -%}
        </div>
      {%- endif -%}
    </div>

    <!-- Product Info -->
    <div class="product__info">
      <div class="product__badges">
        {%- if product.compare_at_price > product.price -%}
          <span class="product__badge product__badge--sale">
            {% assign savings = product.compare_at_price | minus: product.price | times: 100.0 | divided_by: product.compare_at_price | round %}
            Save {{ savings }}%
          </span>
        {%- endif -%}
        <span class="product__badge product__badge--bestseller">‚≠ê Bestseller</span>
      </div>

      <h1 class="product__title">{{ product.title }}</h1>
      <p class="product__subtitle">{{ section.settings.subtitle }}</p>

      <!-- Rating -->
      <div class="product__rating">
        <div class="product__stars">
          {%- for i in (1..5) -%}
            <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
            </svg>
          {%- endfor -%}
        </div>
        <span class="product__rating-text">4.9 ({{ section.settings.review_count | default: "2,847" }} reviews)</span>
      </div>

      <!-- Price -->
      <div class="product__price-wrapper">
        <span class="product__price">{{ product.price | money }}</span>
        {%- if product.compare_at_price > product.price -%}
          <span class="product__compare-price">{{ product.compare_at_price | money }}</span>
          <span class="product__save-badge">
            You save {{ product.compare_at_price | minus: product.price | money }}
          </span>
        {%- endif -%}
      </div>

      <!-- Urgency -->
      {%- if section.settings.show_urgency -%}
        <div class="product__urgency">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <circle cx="12" cy="12" r="10"></circle>
            <polyline points="12 6 12 12 16 14"></polyline>
          </svg>
          {{ section.settings.urgency_text | default: "${urgencyMessage}" }}
        </div>
      {%- endif -%}

      <!-- Social Proof -->
      {%- if section.settings.show_social_proof -%}
        <div class="product__social-proof">
          <div class="product__social-avatars">
            <div class="product__social-avatar"></div>
            <div class="product__social-avatar"></div>
            <div class="product__social-avatar"></div>
            <div class="product__social-avatar"></div>
          </div>
          <span class="product__social-text">
            <strong>{{ section.settings.social_proof_text | default: "${socialProof}" }}</strong>
          </span>
        </div>
      {%- endif -%}

      <!-- Product Form -->
      {%- form 'product', product, id: 'product-form', class: 'product__form' -%}
        <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">

        <!-- Variants -->
        {%- for option in product.options_with_values -%}
          <div class="product__variants">
            <label class="product__variant-label">{{ option.name }}: <strong data-selected-option="{{ option.name }}">{{ option.selected_value }}</strong></label>
            <div class="product__variant-options">
              {%- for value in option.values -%}
                <button
                  type="button"
                  class="product__variant-option{% if option.selected_value == value %} selected{% endif %}"
                  data-option-name="{{ option.name }}"
                  data-option-value="{{ value }}"
                >
                  {{ value }}
                </button>
              {%- endfor -%}
            </div>
          </div>
        {%- endfor -%}

        <!-- Quantity -->
        <div class="product__quantity">
          <label class="product__quantity-label">Quantity</label>
          <div class="product__quantity-selector">
            <button type="button" class="product__quantity-btn" data-quantity-minus>‚àí</button>
            <input type="number" name="quantity" value="1" min="1" class="product__quantity-input" data-quantity-input>
            <button type="button" class="product__quantity-btn" data-quantity-plus>+</button>
          </div>
        </div>

        <!-- Add to Cart -->
        <button type="submit" class="product__add-to-cart" {% unless product.available %}disabled{% endunless %}>
          {%- if product.available -%}
            Add to Cart - {{ product.price | money }}
          {%- else -%}
            Sold Out
          {%- endif -%}
        </button>

        <!-- Buy Now -->
        {%- if section.settings.show_buy_now -%}
          <button type="submit" name="checkout" class="product__buy-now">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
              <path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z"/>
            </svg>
            Buy Now with Shop Pay
          </button>
        {%- endif -%}
      {%- endform -%}

      <!-- Payment Icons -->
      <div class="product__payment-icons">
        <span style="font-size: 0.75rem; color: #999;">Secure checkout with</span>
        {{ shop.enabled_payment_types | payment_type_svg_tag }}
      </div>

      <!-- Trust Badges -->
      <div class="product__trust-badges">
        {%- for badge in section.settings.trust_badges -%}
          <div class="product__trust-badge">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
              <polyline points="22 4 12 14.01 9 11.01"></polyline>
            </svg>
            {{ badge }}
          </div>
        {%- else -%}
          <div class="product__trust-badge">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
              <polyline points="22 4 12 14.01 9 11.01"></polyline>
            </svg>
            Free Shipping Over $75
          </div>
          <div class="product__trust-badge">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
              <polyline points="22 4 12 14.01 9 11.01"></polyline>
            </svg>
            30-Day Money Back
          </div>
          <div class="product__trust-badge">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
              <polyline points="22 4 12 14.01 9 11.01"></polyline>
            </svg>
            Secure Checkout
          </div>
          <div class="product__trust-badge">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
              <polyline points="22 4 12 14.01 9 11.01"></polyline>
            </svg>
            24/7 Support
          </div>
        {%- endfor -%}
      </div>

      <!-- Product Description -->
      <div class="product__description">
        <h3>Product Details</h3>
        <div class="product__description-content">
          {{ product.description }}
        </div>

        {%- if section.settings.bullet_points != blank -%}
          <ul class="product__bullets">
            {%- assign bullets = section.settings.bullet_points | split: '|' -%}
            {%- for bullet in bullets -%}
              <li class="product__bullet">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                  <polyline points="22 4 12 14.01 9 11.01"></polyline>
                </svg>
                {{ bullet }}
              </li>
            {%- endfor -%}
          </ul>
        {%- endif -%}
      </div>
    </div>
  </div>
</section>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Thumbnail click
    document.querySelectorAll('[data-thumbnail]').forEach(thumb => {
      thumb.addEventListener('click', function() {
        const index = this.dataset.thumbnail;
        const images = {{ product.images | json }};
        const mainImage = document.querySelector('[data-product-media-main] img');
        if (mainImage && images[index]) {
          mainImage.src = images[index].src.replace(/\\.(jpg|png|gif|webp)/, '_1200x.$1');
        }
        document.querySelectorAll('[data-thumbnail]').forEach(t => t.classList.remove('active'));
        this.classList.add('active');
      });
    });

    // Quantity buttons
    const qtyInput = document.querySelector('[data-quantity-input]');
    document.querySelector('[data-quantity-minus]')?.addEventListener('click', () => {
      if (qtyInput.value > 1) qtyInput.value = parseInt(qtyInput.value) - 1;
    });
    document.querySelector('[data-quantity-plus]')?.addEventListener('click', () => {
      qtyInput.value = parseInt(qtyInput.value) + 1;
    });

    // Variant selection
    document.querySelectorAll('.product__variant-option').forEach(btn => {
      btn.addEventListener('click', function() {
        const optionName = this.dataset.optionName;
        const optionValue = this.dataset.optionValue;

        // Update UI
        this.closest('.product__variant-options')
          .querySelectorAll('.product__variant-option')
          .forEach(b => b.classList.remove('selected'));
        this.classList.add('selected');

        // Update label
        document.querySelector(\`[data-selected-option="\${optionName}"]\`).textContent = optionValue;

        // Find matching variant
        const variants = {{ product.variants | json }};
        const selectedOptions = {};
        document.querySelectorAll('.product__variant-option.selected').forEach(selected => {
          selectedOptions[selected.dataset.optionName] = selected.dataset.optionValue;
        });

        const matchingVariant = variants.find(v => {
          return Object.keys(selectedOptions).every((key, i) => v['option' + (i + 1)] === selectedOptions[key]);
        });

        if (matchingVariant) {
          document.querySelector('input[name="id"]').value = matchingVariant.id;
        }
      });
    });
  });
</script>

{% schema %}
{
  "name": "Product",
  "tag": "section",
  "class": "section-product",
  "settings": [
    {
      "type": "text",
      "id": "subtitle",
      "label": "Subtitle",
      "default": "Premium quality, exceptional results"
    },
    {
      "type": "text",
      "id": "review_count",
      "label": "Review count",
      "default": "2,847"
    },
    {
      "type": "checkbox",
      "id": "show_urgency",
      "default": true,
      "label": "Show urgency message"
    },
    {
      "type": "text",
      "id": "urgency_text",
      "label": "Urgency text",
      "default": "${urgencyMessage}"
    },
    {
      "type": "checkbox",
      "id": "show_social_proof",
      "default": true,
      "label": "Show social proof"
    },
    {
      "type": "text",
      "id": "social_proof_text",
      "label": "Social proof text",
      "default": "${socialProof}"
    },
    {
      "type": "checkbox",
      "id": "show_buy_now",
      "default": true,
      "label": "Show Buy Now button"
    },
    {
      "type": "textarea",
      "id": "bullet_points",
      "label": "Bullet points (separate with |)",
      "default": "Premium quality materials|Fast & free shipping|30-day money back guarantee|24/7 customer support"
    }
  ],
  "presets": [
    {
      "name": "Product"
    }
  ]
}
{% endschema %}`;
  }

  // ================================
  // Product Hero Section
  // ================================
  generateProductHero() {
    const homepage = this.content.homepage || {};
    const headline = homepage.heroHeadline || "Transform Your Life Today";
    const subheadline = homepage.heroSubheadline || "Join thousands of satisfied customers";
    const ctaButton = homepage.ctaButton || "Shop Now";

    return `{% comment %}
  Nova Theme - Product Hero Section
  Premium hero with product showcase
{% endcomment %}

{%- style -%}
  .hero-section {
    background: {{ section.settings.background_color }};
    padding: 4rem 1rem;
    overflow: hidden;
  }

  .hero__container {
    max-width: 1400px;
    margin: 0 auto;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 4rem;
    align-items: center;
  }

  .hero__content {
    max-width: 600px;
  }

  .hero__badge {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    background: {{ section.settings.accent_color }}15;
    color: {{ section.settings.accent_color }};
    padding: 0.5rem 1rem;
    border-radius: 100px;
    font-size: 0.875rem;
    font-weight: 600;
    margin-bottom: 1.5rem;
  }

  .hero__title {
    font-size: 3.5rem;
    font-weight: 700;
    line-height: 1.1;
    color: {{ section.settings.text_color }};
    margin: 0 0 1.5rem;
  }

  .hero__subtitle {
    font-size: 1.25rem;
    color: {{ section.settings.text_color }}99;
    line-height: 1.6;
    margin-bottom: 2rem;
  }

  .hero__cta {
    display: inline-flex;
    align-items: center;
    gap: 0.75rem;
    background: {{ section.settings.button_color }};
    color: {{ section.settings.button_text_color }};
    padding: 1rem 2rem;
    border-radius: 8px;
    font-size: 1rem;
    font-weight: 600;
    text-decoration: none;
    transition: all 0.2s;
  }

  .hero__cta:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 20px {{ section.settings.button_color }}40;
  }

  .hero__stats {
    display: flex;
    gap: 3rem;
    margin-top: 3rem;
    padding-top: 2rem;
    border-top: 1px solid {{ section.settings.text_color }}15;
  }

  .hero__stat-number {
    font-size: 2rem;
    font-weight: 700;
    color: {{ section.settings.text_color }};
  }

  .hero__stat-label {
    font-size: 0.875rem;
    color: {{ section.settings.text_color }}80;
  }

  .hero__image-wrapper {
    position: relative;
  }

  .hero__image {
    width: 100%;
    height: auto;
    border-radius: 16px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.15);
  }

  .hero__floating-badge {
    position: absolute;
    background: white;
    padding: 1rem 1.5rem;
    border-radius: 12px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    font-size: 0.875rem;
  }

  .hero__floating-badge--rating {
    top: 10%;
    right: -20px;
  }

  .hero__floating-badge--shipping {
    bottom: 10%;
    left: -20px;
  }

  @media (max-width: 968px) {
    .hero__container {
      grid-template-columns: 1fr;
      text-align: center;
    }

    .hero__content {
      max-width: 100%;
    }

    .hero__title {
      font-size: 2.5rem;
    }

    .hero__stats {
      justify-content: center;
    }

    .hero__image-wrapper {
      order: -1;
    }
  }
{%- endstyle -%}

<section class="hero-section">
  <div class="hero__container">
    <div class="hero__content">
      <div class="hero__badge">
        ‚≠ê {{ section.settings.badge_text | default: "Rated #1 by customers" }}
      </div>

      <h1 class="hero__title">{{ section.settings.heading | default: "${headline}" }}</h1>
      <p class="hero__subtitle">{{ section.settings.subheading | default: "${subheadline}" }}</p>

      <a href="{{ section.settings.button_link | default: routes.all_products_collection_url }}" class="hero__cta">
        {{ section.settings.button_text | default: "${ctaButton}" }}
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <line x1="5" y1="12" x2="19" y2="12"></line>
          <polyline points="12 5 19 12 12 19"></polyline>
        </svg>
      </a>

      {%- if section.settings.show_stats -%}
        <div class="hero__stats">
          {%- for block in section.blocks -%}
            {%- if block.type == 'stat' -%}
              <div class="hero__stat">
                <div class="hero__stat-number">{{ block.settings.number }}</div>
                <div class="hero__stat-label">{{ block.settings.label }}</div>
              </div>
            {%- endif -%}
          {%- endfor -%}
        </div>
      {%- endif -%}
    </div>

    <div class="hero__image-wrapper">
      {%- if section.settings.image != blank -%}
        <img src="{{ section.settings.image | image_url: width: 1200 }}" alt="{{ section.settings.image.alt }}" class="hero__image">
      {%- else -%}
        {{ 'lifestyle-1' | placeholder_svg_tag: 'hero__image' }}
      {%- endif -%}

      {%- if section.settings.show_floating_badges -%}
        <div class="hero__floating-badge hero__floating-badge--rating">
          <strong>‚≠ê 4.9/5</strong><br>
          <span style="color: #666;">2,847 reviews</span>
        </div>
        <div class="hero__floating-badge hero__floating-badge--shipping">
          <strong>üöö Free Shipping</strong><br>
          <span style="color: #666;">On orders $75+</span>
        </div>
      {%- endif -%}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Hero",
  "settings": [
    {
      "type": "text",
      "id": "badge_text",
      "label": "Badge text",
      "default": "Rated #1 by customers"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "${headline}"
    },
    {
      "type": "textarea",
      "id": "subheading",
      "label": "Subheading",
      "default": "${subheadline}"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button text",
      "default": "${ctaButton}"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "Button link"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "Image"
    },
    {
      "type": "checkbox",
      "id": "show_stats",
      "default": true,
      "label": "Show stats"
    },
    {
      "type": "checkbox",
      "id": "show_floating_badges",
      "default": true,
      "label": "Show floating badges"
    },
    {
      "type": "color",
      "id": "background_color",
      "default": "#fafafa",
      "label": "Background color"
    },
    {
      "type": "color",
      "id": "text_color",
      "default": "#1a1a1a",
      "label": "Text color"
    },
    {
      "type": "color",
      "id": "accent_color",
      "default": "#5a31f4",
      "label": "Accent color"
    },
    {
      "type": "color",
      "id": "button_color",
      "default": "#1a1a1a",
      "label": "Button color"
    },
    {
      "type": "color",
      "id": "button_text_color",
      "default": "#ffffff",
      "label": "Button text color"
    }
  ],
  "blocks": [
    {
      "type": "stat",
      "name": "Stat",
      "settings": [
        {
          "type": "text",
          "id": "number",
          "label": "Number",
          "default": "50K+"
        },
        {
          "type": "text",
          "id": "label",
          "label": "Label",
          "default": "Happy Customers"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Hero",
      "blocks": [
        {
          "type": "stat",
          "settings": {
            "number": "50K+",
            "label": "Happy Customers"
          }
        },
        {
          "type": "stat",
          "settings": {
            "number": "4.9",
            "label": "Average Rating"
          }
        },
        {
          "type": "stat",
          "settings": {
            "number": "30",
            "label": "Day Guarantee"
          }
        }
      ]
    }
  ]
}
{% endschema %}`;
  }

  // ================================
  // Testimonials Section
  // ================================
  generateTestimonials() {
    const testimonials = this.content.homepage?.testimonials || [];

    return `{% comment %}
  Nova Theme - Testimonials Section
{% endcomment %}

{%- style -%}
  .testimonials-section {
    padding: 5rem 1rem;
    background: {{ section.settings.background_color }};
  }

  .testimonials__container {
    max-width: 1200px;
    margin: 0 auto;
  }

  .testimonials__header {
    text-align: center;
    margin-bottom: 3rem;
  }

  .testimonials__title {
    font-size: 2.5rem;
    font-weight: 700;
    color: {{ section.settings.text_color }};
    margin: 0 0 1rem;
  }

  .testimonials__subtitle {
    font-size: 1.125rem;
    color: {{ section.settings.text_color }}80;
  }

  .testimonials__grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 2rem;
  }

  .testimonial-card {
    background: white;
    border-radius: 16px;
    padding: 2rem;
    box-shadow: 0 4px 20px rgba(0,0,0,0.05);
    transition: transform 0.2s, box-shadow 0.2s;
  }

  .testimonial-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 30px rgba(0,0,0,0.1);
  }

  .testimonial__stars {
    display: flex;
    gap: 2px;
    color: #f59e0b;
    margin-bottom: 1rem;
  }

  .testimonial__quote {
    font-size: 1rem;
    line-height: 1.7;
    color: {{ section.settings.text_color }};
    margin-bottom: 1.5rem;
  }

  .testimonial__author {
    display: flex;
    align-items: center;
    gap: 1rem;
  }

  .testimonial__avatar {
    width: 48px;
    height: 48px;
    border-radius: 50%;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-weight: 600;
  }

  .testimonial__name {
    font-weight: 600;
    color: {{ section.settings.text_color }};
  }

  .testimonial__title {
    font-size: 0.875rem;
    color: {{ section.settings.text_color }}80;
  }

  .testimonial__verified {
    display: inline-flex;
    align-items: center;
    gap: 0.25rem;
    font-size: 0.75rem;
    color: #16a34a;
    margin-top: 0.25rem;
  }

  @media (max-width: 968px) {
    .testimonials__grid {
      grid-template-columns: 1fr;
    }
  }
{%- endstyle -%}

<section class="testimonials-section">
  <div class="testimonials__container">
    <div class="testimonials__header">
      <h2 class="testimonials__title">{{ section.settings.heading | default: "What Our Customers Say" }}</h2>
      <p class="testimonials__subtitle">{{ section.settings.subheading | default: "Join thousands of satisfied customers" }}</p>
    </div>

    <div class="testimonials__grid">
      {%- for block in section.blocks -%}
        <div class="testimonial-card" {{ block.shopify_attributes }}>
          <div class="testimonial__stars">
            {%- for i in (1..5) -%}
              <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
              </svg>
            {%- endfor -%}
          </div>
          <p class="testimonial__quote">"{{ block.settings.quote }}"</p>
          <div class="testimonial__author">
            <div class="testimonial__avatar">{{ block.settings.author | slice: 0 }}</div>
            <div>
              <div class="testimonial__name">{{ block.settings.author }}</div>
              <div class="testimonial__title">{{ block.settings.title | default: "Verified Buyer" }}</div>
              <div class="testimonial__verified">
                <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M12 22C6.477 22 2 17.523 2 12S6.477 2 12 2s10 4.477 10 10-4.477 10-10 10zm-.997-6l7.07-7.071-1.414-1.414-5.656 5.657-2.829-2.829-1.414 1.414L11.003 16z"/>
                </svg>
                Verified Purchase
              </div>
            </div>
          </div>
        </div>
      {%- endfor -%}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Testimonials",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "What Our Customers Say"
    },
    {
      "type": "text",
      "id": "subheading",
      "label": "Subheading",
      "default": "Join thousands of satisfied customers"
    },
    {
      "type": "color",
      "id": "background_color",
      "default": "#f8f8f8",
      "label": "Background color"
    },
    {
      "type": "color",
      "id": "text_color",
      "default": "#1a1a1a",
      "label": "Text color"
    }
  ],
  "blocks": [
    {
      "type": "testimonial",
      "name": "Testimonial",
      "settings": [
        {
          "type": "textarea",
          "id": "quote",
          "label": "Quote",
          "default": "This product exceeded all my expectations. The quality is outstanding and it arrived faster than expected!"
        },
        {
          "type": "text",
          "id": "author",
          "label": "Author name",
          "default": "Sarah M."
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "Verified Buyer"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Testimonials",
      "blocks": [
        {
          "type": "testimonial",
          "settings": {
            "quote": "${testimonials[0]?.quote || "This product exceeded all my expectations. The quality is outstanding!"}",
            "author": "${testimonials[0]?.author || "Sarah M."}",
            "title": "Verified Buyer"
          }
        },
        {
          "type": "testimonial",
          "settings": {
            "quote": "${testimonials[1]?.quote || "Best purchase I've made this year. Highly recommend to everyone!"}",
            "author": "${testimonials[1]?.author || "Mike R."}",
            "title": "Verified Buyer"
          }
        },
        {
          "type": "testimonial",
          "settings": {
            "quote": "${testimonials[2]?.quote || "Amazing customer service and the product quality is top-notch."}",
            "author": "${testimonials[2]?.author || "Emily L."}",
            "title": "Verified Buyer"
          }
        }
      ]
    }
  ]
}
{% endschema %}`;
  }

  // ================================
  // Features Grid Section
  // ================================
  generateFeaturesGrid() {
    const features = this.content.homepage?.features || [];

    return `{% comment %}
  Nova Theme - Features Grid Section
{% endcomment %}

{%- style -%}
  .features-section {
    padding: 5rem 1rem;
    background: {{ section.settings.background_color }};
  }

  .features__container {
    max-width: 1200px;
    margin: 0 auto;
  }

  .features__header {
    text-align: center;
    margin-bottom: 3rem;
  }

  .features__title {
    font-size: 2.5rem;
    font-weight: 700;
    color: {{ section.settings.text_color }};
    margin: 0 0 1rem;
  }

  .features__grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 2rem;
  }

  .feature-card {
    text-align: center;
    padding: 2rem;
  }

  .feature__icon {
    width: 64px;
    height: 64px;
    margin: 0 auto 1.5rem;
    background: {{ section.settings.icon_background }};
    border-radius: 16px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2rem;
  }

  .feature__title {
    font-size: 1.25rem;
    font-weight: 600;
    color: {{ section.settings.text_color }};
    margin: 0 0 0.75rem;
  }

  .feature__description {
    font-size: 1rem;
    color: {{ section.settings.text_color }}80;
    line-height: 1.6;
  }

  @media (max-width: 768px) {
    .features__grid {
      grid-template-columns: 1fr;
    }
  }
{%- endstyle -%}

<section class="features-section">
  <div class="features__container">
    {%- if section.settings.heading != blank -%}
      <div class="features__header">
        <h2 class="features__title">{{ section.settings.heading }}</h2>
      </div>
    {%- endif -%}

    <div class="features__grid">
      {%- for block in section.blocks -%}
        <div class="feature-card" {{ block.shopify_attributes }}>
          <div class="feature__icon">{{ block.settings.icon }}</div>
          <h3 class="feature__title">{{ block.settings.title }}</h3>
          <p class="feature__description">{{ block.settings.description }}</p>
        </div>
      {%- endfor -%}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Features",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Why Choose Us"
    },
    {
      "type": "color",
      "id": "background_color",
      "default": "#ffffff",
      "label": "Background color"
    },
    {
      "type": "color",
      "id": "text_color",
      "default": "#1a1a1a",
      "label": "Text color"
    },
    {
      "type": "color",
      "id": "icon_background",
      "default": "#f0f0f0",
      "label": "Icon background"
    }
  ],
  "blocks": [
    {
      "type": "feature",
      "name": "Feature",
      "settings": [
        {
          "type": "text",
          "id": "icon",
          "label": "Icon (emoji)",
          "default": "‚ú®"
        },
        {
          "type": "text",
          "id": "title",
          "label": "Title",
          "default": "Premium Quality"
        },
        {
          "type": "textarea",
          "id": "description",
          "label": "Description",
          "default": "We use only the finest materials to ensure lasting quality."
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Features",
      "blocks": [
        {
          "type": "feature",
          "settings": {
            "icon": "${features[0]?.icon || "üéØ"}",
            "title": "${features[0]?.title || "Premium Quality"}",
            "description": "${features[0]?.description || "We use only the finest materials."}"
          }
        },
        {
          "type": "feature",
          "settings": {
            "icon": "${features[1]?.icon || "‚ö°"}",
            "title": "${features[1]?.title || "Fast Shipping"}",
            "description": "${features[1]?.description || "Free express shipping on all orders."}"
          }
        },
        {
          "type": "feature",
          "settings": {
            "icon": "${features[2]?.icon || "üíé"}",
            "title": "${features[2]?.title || "30-Day Guarantee"}",
            "description": "${features[2]?.description || "Not satisfied? Full refund, no questions asked."}"
          }
        }
      ]
    }
  ]
}
{% endschema %}`;
  }

  // ================================
  // FAQ Section
  // ================================
  generateFAQ() {
    const faqs = this.content.faq || [];

    return `{% comment %}
  Nova Theme - FAQ Section
{% endcomment %}

{%- style -%}
  .faq-section {
    padding: 5rem 1rem;
    background: {{ section.settings.background_color }};
  }

  .faq__container {
    max-width: 800px;
    margin: 0 auto;
  }

  .faq__header {
    text-align: center;
    margin-bottom: 3rem;
  }

  .faq__title {
    font-size: 2.5rem;
    font-weight: 700;
    color: {{ section.settings.text_color }};
    margin: 0 0 1rem;
  }

  .faq__list {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .faq-item {
    border: 1px solid #e5e5e5;
    border-radius: 12px;
    overflow: hidden;
  }

  .faq__question {
    width: 100%;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1.25rem 1.5rem;
    background: white;
    border: none;
    cursor: pointer;
    text-align: left;
    font-size: 1rem;
    font-weight: 600;
    color: {{ section.settings.text_color }};
    transition: background 0.2s;
  }

  .faq__question:hover {
    background: #f8f8f8;
  }

  .faq__question svg {
    flex-shrink: 0;
    transition: transform 0.2s;
  }

  .faq-item.open .faq__question svg {
    transform: rotate(180deg);
  }

  .faq__answer {
    display: none;
    padding: 0 1.5rem 1.25rem;
    color: {{ section.settings.text_color }}80;
    line-height: 1.7;
  }

  .faq-item.open .faq__answer {
    display: block;
  }
{%- endstyle -%}

<section class="faq-section">
  <div class="faq__container">
    <div class="faq__header">
      <h2 class="faq__title">{{ section.settings.heading | default: "Frequently Asked Questions" }}</h2>
    </div>

    <div class="faq__list">
      {%- for block in section.blocks -%}
        <div class="faq-item" {{ block.shopify_attributes }}>
          <button class="faq__question" type="button" aria-expanded="false">
            {{ block.settings.question }}
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
          </button>
          <div class="faq__answer">
            {{ block.settings.answer }}
          </div>
        </div>
      {%- endfor -%}
    </div>
  </div>
</section>

<script>
  document.querySelectorAll('.faq__question').forEach(btn => {
    btn.addEventListener('click', function() {
      const item = this.closest('.faq-item');
      const isOpen = item.classList.contains('open');

      // Close all
      document.querySelectorAll('.faq-item').forEach(i => i.classList.remove('open'));

      // Toggle current
      if (!isOpen) {
        item.classList.add('open');
        this.setAttribute('aria-expanded', 'true');
      }
    });
  });
</script>

{% schema %}
{
  "name": "FAQ",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Frequently Asked Questions"
    },
    {
      "type": "color",
      "id": "background_color",
      "default": "#ffffff",
      "label": "Background color"
    },
    {
      "type": "color",
      "id": "text_color",
      "default": "#1a1a1a",
      "label": "Text color"
    }
  ],
  "blocks": [
    {
      "type": "faq",
      "name": "FAQ item",
      "settings": [
        {
          "type": "text",
          "id": "question",
          "label": "Question",
          "default": "How long does shipping take?"
        },
        {
          "type": "textarea",
          "id": "answer",
          "label": "Answer",
          "default": "We offer free standard shipping (5-7 business days) on all orders over $75. Express shipping (2-3 business days) is available for $9.99."
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "FAQ",
      "blocks": [
        {
          "type": "faq",
          "settings": {
            "question": "${faqs[0]?.question || "How long does shipping take?"}",
            "answer": "${faqs[0]?.answer || "Free standard shipping takes 5-7 business days."}"
          }
        },
        {
          "type": "faq",
          "settings": {
            "question": "${faqs[1]?.question || "What is your return policy?"}",
            "answer": "${faqs[1]?.answer || "We offer a 30-day money back guarantee."}"
          }
        },
        {
          "type": "faq",
          "settings": {
            "question": "${faqs[2]?.question || "Is this product high quality?"}",
            "answer": "${faqs[2]?.answer || "Yes, we use only premium materials."}"
          }
        }
      ]
    }
  ]
}
{% endschema %}`;
  }

  // ================================
  // Trust Badges Section
  // ================================
  generateTrustBadges() {
    const badges = this.content.trustBadges || [];

    return `{% comment %}
  Nova Theme - Trust Badges
{% endcomment %}

{%- style -%}
  .trust-badges {
    padding: 2rem 1rem;
    background: {{ section.settings.background_color }};
    border-top: 1px solid #e5e5e5;
    border-bottom: 1px solid #e5e5e5;
  }

  .trust-badges__container {
    max-width: 1200px;
    margin: 0 auto;
    display: flex;
    justify-content: center;
    align-items: center;
    flex-wrap: wrap;
    gap: 2rem;
  }

  .trust-badge {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    font-size: 0.875rem;
    color: {{ section.settings.text_color }};
  }

  .trust-badge__icon {
    width: 40px;
    height: 40px;
    background: {{ section.settings.icon_background }};
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .trust-badge__icon svg {
    color: {{ section.settings.icon_color }};
  }
{%- endstyle -%}

<section class="trust-badges">
  <div class="trust-badges__container">
    {%- for block in section.blocks -%}
      <div class="trust-badge" {{ block.shopify_attributes }}>
        <div class="trust-badge__icon">
          {%- case block.settings.icon -%}
            {%- when 'shipping' -%}
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="1" y="3" width="15" height="13"></rect>
                <polygon points="16 8 20 8 23 11 23 16 16 16 16 8"></polygon>
                <circle cx="5.5" cy="18.5" r="2.5"></circle>
                <circle cx="18.5" cy="18.5" r="2.5"></circle>
              </svg>
            {%- when 'guarantee' -%}
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
                <polyline points="9 12 12 15 16 10"></polyline>
              </svg>
            {%- when 'secure' -%}
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
              </svg>
            {%- when 'support' -%}
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
              </svg>
            {%- else -%}
              <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <polyline points="20 6 9 17 4 12"></polyline>
              </svg>
          {%- endcase -%}
        </div>
        <span>{{ block.settings.text }}</span>
      </div>
    {%- endfor -%}
  </div>
</section>

{% schema %}
{
  "name": "Trust badges",
  "settings": [
    {
      "type": "color",
      "id": "background_color",
      "default": "#fafafa",
      "label": "Background color"
    },
    {
      "type": "color",
      "id": "text_color",
      "default": "#1a1a1a",
      "label": "Text color"
    },
    {
      "type": "color",
      "id": "icon_background",
      "default": "#e8f5e9",
      "label": "Icon background"
    },
    {
      "type": "color",
      "id": "icon_color",
      "default": "#16a34a",
      "label": "Icon color"
    }
  ],
  "blocks": [
    {
      "type": "badge",
      "name": "Badge",
      "settings": [
        {
          "type": "select",
          "id": "icon",
          "label": "Icon",
          "options": [
            { "value": "shipping", "label": "Shipping" },
            { "value": "guarantee", "label": "Guarantee" },
            { "value": "secure", "label": "Secure" },
            { "value": "support", "label": "Support" },
            { "value": "check", "label": "Check" }
          ],
          "default": "shipping"
        },
        {
          "type": "text",
          "id": "text",
          "label": "Text",
          "default": "Free Shipping"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Trust badges",
      "blocks": [
        {
          "type": "badge",
          "settings": {
            "icon": "shipping",
            "text": "${badges[0] || "Free Shipping Over $75"}"
          }
        },
        {
          "type": "badge",
          "settings": {
            "icon": "guarantee",
            "text": "${badges[1] || "30-Day Money Back"}"
          }
        },
        {
          "type": "badge",
          "settings": {
            "icon": "secure",
            "text": "${badges[2] || "Secure Checkout"}"
          }
        },
        {
          "type": "badge",
          "settings": {
            "icon": "support",
            "text": "${badges[3] || "24/7 Support"}"
          }
        }
      ]
    }
  ]
}
{% endschema %}`;
  }

  // ================================
  // Footer Section
  // ================================
  generateFooter() {
    return `{% comment %}
  Nova Theme - Footer Section
{% endcomment %}

{%- style -%}
  .footer {
    background: {{ section.settings.background_color }};
    color: {{ section.settings.text_color }};
    padding: 4rem 1rem 2rem;
  }

  .footer__container {
    max-width: 1200px;
    margin: 0 auto;
  }

  .footer__grid {
    display: grid;
    grid-template-columns: 2fr 1fr 1fr 1fr;
    gap: 3rem;
    margin-bottom: 3rem;
  }

  .footer__brand-name {
    font-size: 1.5rem;
    font-weight: 700;
    margin-bottom: 1rem;
  }

  .footer__brand-description {
    color: {{ section.settings.text_color }}80;
    line-height: 1.6;
    margin-bottom: 1.5rem;
  }

  .footer__social {
    display: flex;
    gap: 1rem;
  }

  .footer__social a {
    color: {{ section.settings.text_color }};
    transition: opacity 0.2s;
  }

  .footer__social a:hover {
    opacity: 0.7;
  }

  .footer__heading {
    font-size: 0.875rem;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    margin-bottom: 1.25rem;
  }

  .footer__links {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .footer__links li {
    margin-bottom: 0.75rem;
  }

  .footer__links a {
    color: {{ section.settings.text_color }}80;
    text-decoration: none;
    transition: color 0.2s;
  }

  .footer__links a:hover {
    color: {{ section.settings.text_color }};
  }

  .footer__bottom {
    padding-top: 2rem;
    border-top: 1px solid {{ section.settings.text_color }}20;
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
    gap: 1rem;
  }

  .footer__copyright {
    font-size: 0.875rem;
    color: {{ section.settings.text_color }}60;
  }

  .footer__payments {
    display: flex;
    gap: 0.5rem;
  }

  @media (max-width: 768px) {
    .footer__grid {
      grid-template-columns: 1fr 1fr;
    }
  }

  @media (max-width: 480px) {
    .footer__grid {
      grid-template-columns: 1fr;
    }
  }
{%- endstyle -%}

<footer class="footer">
  <div class="footer__container">
    <div class="footer__grid">
      <div class="footer__brand">
        <div class="footer__brand-name">{{ shop.name }}</div>
        <p class="footer__brand-description">{{ section.settings.description | default: "Premium products for your lifestyle. Quality you can trust." }}</p>
        <div class="footer__social">
          {%- if section.settings.facebook_url != blank -%}
            <a href="{{ section.settings.facebook_url }}" aria-label="Facebook">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path d="M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"/>
              </svg>
            </a>
          {%- endif -%}
          {%- if section.settings.instagram_url != blank -%}
            <a href="{{ section.settings.instagram_url }}" aria-label="Instagram">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="2" y="2" width="20" height="20" rx="5" ry="5"/>
                <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"/>
                <line x1="17.5" y1="6.5" x2="17.51" y2="6.5"/>
              </svg>
            </a>
          {%- endif -%}
          {%- if section.settings.twitter_url != blank -%}
            <a href="{{ section.settings.twitter_url }}" aria-label="Twitter">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                <path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"/>
              </svg>
            </a>
          {%- endif -%}
        </div>
      </div>

      {%- for block in section.blocks -%}
        {%- if block.type == 'menu' -%}
          <div class="footer__column" {{ block.shopify_attributes }}>
            <h4 class="footer__heading">{{ block.settings.heading }}</h4>
            <ul class="footer__links">
              {%- for link in linklists[block.settings.menu].links -%}
                <li><a href="{{ link.url }}">{{ link.title }}</a></li>
              {%- endfor -%}
            </ul>
          </div>
        {%- endif -%}
      {%- endfor -%}
    </div>

    <div class="footer__bottom">
      <p class="footer__copyright">¬© {{ 'now' | date: '%Y' }} {{ shop.name }}. All rights reserved.</p>
      <div class="footer__payments">
        {{ shop.enabled_payment_types | payment_type_svg_tag }}
      </div>
    </div>
  </div>
</footer>

{% schema %}
{
  "name": "Footer",
  "settings": [
    {
      "type": "textarea",
      "id": "description",
      "label": "Description",
      "default": "Premium products for your lifestyle. Quality you can trust."
    },
    {
      "type": "url",
      "id": "facebook_url",
      "label": "Facebook URL"
    },
    {
      "type": "url",
      "id": "instagram_url",
      "label": "Instagram URL"
    },
    {
      "type": "url",
      "id": "twitter_url",
      "label": "Twitter URL"
    },
    {
      "type": "color",
      "id": "background_color",
      "default": "#1a1a1a",
      "label": "Background color"
    },
    {
      "type": "color",
      "id": "text_color",
      "default": "#ffffff",
      "label": "Text color"
    }
  ],
  "blocks": [
    {
      "type": "menu",
      "name": "Menu column",
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "label": "Heading",
          "default": "Quick Links"
        },
        {
          "type": "link_list",
          "id": "menu",
          "label": "Menu",
          "default": "footer"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Footer",
      "blocks": [
        {
          "type": "menu",
          "settings": {
            "heading": "Shop",
            "menu": "main-menu"
          }
        },
        {
          "type": "menu",
          "settings": {
            "heading": "Support",
            "menu": "footer"
          }
        },
        {
          "type": "menu",
          "settings": {
            "heading": "Legal",
            "menu": "footer"
          }
        }
      ]
    }
  ]
}
{% endschema %}`;
  }

  // ================================
  // Helper snippets
  // ================================
  generatePriceSnippet() {
    return `{% comment %}
  Nova Theme - Price Snippet
{% endcomment %}

<div class="price {{ class }}" {{ block.shopify_attributes }}>
  {%- if product.compare_at_price > product.price -%}
    <span class="price__sale">{{ product.price | money }}</span>
    <span class="price__compare">{{ product.compare_at_price | money }}</span>
    <span class="price__badge">Save {{ product.compare_at_price | minus: product.price | times: 100.0 | divided_by: product.compare_at_price | round }}%</span>
  {%- else -%}
    <span class="price__regular">{{ product.price | money }}</span>
  {%- endif -%}
</div>`;
  }

  generateProductMedia() {
    return `{% comment %}
  Nova Theme - Product Media Snippet
{% endcomment %}

<div class="product-media {{ class }}">
  {%- if media.media_type == 'image' -%}
    <img
      src="{{ media | image_url: width: 1200 }}"
      alt="{{ media.alt | escape }}"
      width="{{ media.width }}"
      height="{{ media.height }}"
      loading="{{ loading | default: 'lazy' }}"
    >
  {%- elsif media.media_type == 'video' -%}
    {{ media | video_tag: autoplay: true, loop: true, muted: true }}
  {%- endif -%}
</div>`;
  }

  generateQuantityInput() {
    return `{% comment %}
  Nova Theme - Quantity Input Snippet
{% endcomment %}

<div class="quantity-input">
  <button type="button" class="quantity-input__btn" aria-label="Decrease quantity" data-action="decrease">
    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <line x1="5" y1="12" x2="19" y2="12"></line>
    </svg>
  </button>
  <input
    type="number"
    name="quantity"
    value="{{ value | default: 1 }}"
    min="{{ min | default: 1 }}"
    max="{{ max | default: '' }}"
    class="quantity-input__field"
  >
  <button type="button" class="quantity-input__btn" aria-label="Increase quantity" data-action="increase">
    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <line x1="12" y1="5" x2="12" y2="19"></line>
      <line x1="5" y1="12" x2="19" y2="12"></line>
    </svg>
  </button>
</div>`;
  }

  generateBuyButtons() {
    return `{% comment %}
  Nova Theme - Buy Buttons Snippet
{% endcomment %}

<div class="buy-buttons {{ class }}">
  <button type="submit" class="buy-buttons__add-to-cart" {% unless product.available %}disabled{% endunless %}>
    {%- if product.available -%}
      Add to Cart
    {%- else -%}
      Sold Out
    {%- endif -%}
  </button>

  {%- if show_dynamic_checkout -%}
    {{ form | payment_button }}
  {%- endif -%}
</div>`;
  }

  generateIconStar() {
    return `<svg width="{{ size | default: 16 }}" height="{{ size | default: 16 }}" viewBox="0 0 24 24" fill="{{ fill | default: 'currentColor' }}" class="{{ class }}">
  <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
</svg>`;
  }

  generateFeaturedProduct() {
    return this.generateMainProduct();
  }

  generateImageWithText() {
    return `{% comment %}
  Nova Theme - Image with Text Section
{% endcomment %}

{%- style -%}
  .image-with-text {
    padding: 5rem 1rem;
    background: {{ section.settings.background_color }};
  }

  .image-with-text__container {
    max-width: 1200px;
    margin: 0 auto;
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 4rem;
    align-items: center;
  }

  .image-with-text--reverse .image-with-text__container {
    direction: rtl;
  }

  .image-with-text--reverse .image-with-text__container > * {
    direction: ltr;
  }

  .image-with-text__image {
    border-radius: 16px;
    overflow: hidden;
  }

  .image-with-text__image img {
    width: 100%;
    height: auto;
  }

  .image-with-text__content {
    padding: 2rem 0;
  }

  .image-with-text__heading {
    font-size: 2.5rem;
    font-weight: 700;
    color: {{ section.settings.text_color }};
    margin: 0 0 1.5rem;
    line-height: 1.2;
  }

  .image-with-text__text {
    color: {{ section.settings.text_color }}80;
    line-height: 1.7;
    margin-bottom: 2rem;
  }

  .image-with-text__button {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    background: {{ section.settings.button_color }};
    color: {{ section.settings.button_text_color }};
    padding: 1rem 2rem;
    border-radius: 8px;
    text-decoration: none;
    font-weight: 600;
    transition: transform 0.2s;
  }

  .image-with-text__button:hover {
    transform: translateY(-2px);
  }

  @media (max-width: 768px) {
    .image-with-text__container {
      grid-template-columns: 1fr;
    }

    .image-with-text__heading {
      font-size: 2rem;
    }
  }
{%- endstyle -%}

<section class="image-with-text{% if section.settings.image_position == 'right' %} image-with-text--reverse{% endif %}">
  <div class="image-with-text__container">
    <div class="image-with-text__image">
      {%- if section.settings.image != blank -%}
        <img src="{{ section.settings.image | image_url: width: 1200 }}" alt="{{ section.settings.image.alt }}">
      {%- else -%}
        {{ 'lifestyle-2' | placeholder_svg_tag }}
      {%- endif -%}
    </div>

    <div class="image-with-text__content">
      <h2 class="image-with-text__heading">{{ section.settings.heading | default: "Why Choose Us" }}</h2>
      <div class="image-with-text__text">{{ section.settings.text | default: "We're committed to providing the best products and exceptional customer service." }}</div>
      {%- if section.settings.button_text != blank -%}
        <a href="{{ section.settings.button_link }}" class="image-with-text__button">
          {{ section.settings.button_text }}
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="5" y1="12" x2="19" y2="12"></line>
            <polyline points="12 5 19 12 12 19"></polyline>
          </svg>
        </a>
      {%- endif -%}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Image with text",
  "settings": [
    {
      "type": "image_picker",
      "id": "image",
      "label": "Image"
    },
    {
      "type": "select",
      "id": "image_position",
      "label": "Image position",
      "options": [
        { "value": "left", "label": "Left" },
        { "value": "right", "label": "Right" }
      ],
      "default": "left"
    },
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Why Choose Us"
    },
    {
      "type": "richtext",
      "id": "text",
      "label": "Text",
      "default": "<p>We're committed to providing the best products and exceptional customer service.</p>"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button text",
      "default": "Learn More"
    },
    {
      "type": "url",
      "id": "button_link",
      "label": "Button link"
    },
    {
      "type": "color",
      "id": "background_color",
      "default": "#ffffff",
      "label": "Background"
    },
    {
      "type": "color",
      "id": "text_color",
      "default": "#1a1a1a",
      "label": "Text color"
    },
    {
      "type": "color",
      "id": "button_color",
      "default": "#1a1a1a",
      "label": "Button color"
    },
    {
      "type": "color",
      "id": "button_text_color",
      "default": "#ffffff",
      "label": "Button text"
    }
  ],
  "presets": [
    {
      "name": "Image with text"
    }
  ]
}
{% endschema %}`;
  }

  // ================================
  // Template JSON Files
  // ================================
  generateIndexTemplate() {
    return JSON.stringify({
      "sections": {
        "announcement-bar": {
          "type": "announcement-bar",
          "settings": {}
        },
        "header": {
          "type": "header",
          "settings": {}
        },
        "hero": {
          "type": "product-hero",
          "settings": {}
        },
        "trust-badges": {
          "type": "trust-badges",
          "settings": {}
        },
        "features": {
          "type": "features-grid",
          "settings": {}
        },
        "testimonials": {
          "type": "testimonials",
          "settings": {}
        },
        "faq": {
          "type": "faq",
          "settings": {}
        },
        "footer": {
          "type": "footer",
          "settings": {}
        }
      },
      "order": [
        "announcement-bar",
        "header",
        "hero",
        "trust-badges",
        "features",
        "testimonials",
        "faq",
        "footer"
      ]
    }, null, 2);
  }

  generateProductTemplate() {
    return JSON.stringify({
      "sections": {
        "announcement-bar": {
          "type": "announcement-bar",
          "settings": {}
        },
        "header": {
          "type": "header",
          "settings": {}
        },
        "main-product": {
          "type": "main-product",
          "settings": {}
        },
        "testimonials": {
          "type": "testimonials",
          "settings": {}
        },
        "faq": {
          "type": "faq",
          "settings": {}
        },
        "footer": {
          "type": "footer",
          "settings": {}
        }
      },
      "order": [
        "announcement-bar",
        "header",
        "main-product",
        "testimonials",
        "faq",
        "footer"
      ]
    }, null, 2);
  }

  generateSettingsSchema() {
    return JSON.stringify([
      {
        "name": "theme_info",
        "theme_name": "Nova Theme",
        "theme_version": "1.0.0",
        "theme_author": "Nova AI Store Builder"
      },
      {
        "name": "Colors",
        "settings": [
          {
            "type": "color",
            "id": "colors_primary",
            "label": "Primary color",
            "default": "#1a1a1a"
          },
          {
            "type": "color",
            "id": "colors_secondary",
            "label": "Secondary color",
            "default": "#5a31f4"
          },
          {
            "type": "color",
            "id": "colors_background",
            "label": "Background color",
            "default": "#ffffff"
          },
          {
            "type": "color",
            "id": "colors_text",
            "label": "Text color",
            "default": "#1a1a1a"
          }
        ]
      },
      {
        "name": "Typography",
        "settings": [
          {
            "type": "font_picker",
            "id": "type_header_font",
            "label": "Heading font",
            "default": "assistant_n4"
          },
          {
            "type": "font_picker",
            "id": "type_body_font",
            "label": "Body font",
            "default": "assistant_n4"
          }
        ]
      }
    ], null, 2);
  }

  generateSettingsData() {
    const brand = this.content.brand || {};

    return JSON.stringify({
      "current": {
        "colors_primary": brand.primaryColor || "#1a1a1a",
        "colors_secondary": brand.secondaryColor || "#5a31f4",
        "colors_background": "#ffffff",
        "colors_text": "#1a1a1a"
      }
    }, null, 2);
  }
}

export default ThemeGenerator;
